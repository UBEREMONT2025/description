# План разработки архитектуры Уберемонт

Ниже пошаговый план разработки архитектуры на основе текущего HLA.
Подход итеративный: каждый шаг завершаетcя понятными артефактами,
которые согласуются с бизнесом и командами.

## 1. Уточнение рамок и целей
**Что делаем:**
- фиксируем цель платформы и метрики успеха;
- определяем стейкхолдеров и зоны ответственности;
- уточняем регуляторные и юридические требования.

**Результат:** согласованные рамки, предпосылки, КПИ.

**Вопросы:**
1) Какая целевая география (город/регион/страна)?
2) Нужны ли юридически значимые ЭП уже в МВП?

## 2. Приоритизация ключевых сценариев (МВП и следующие волны)
**Что делаем:**
- фиксируем 5–7 ключевых сценариев МВП;
- определяем, что точно не входит в МВП;
- задаем минимально нужные статусы и данные.

**Предлагаемые сценарии МВП (включая тендеры):**
1) Лид -> сделка -> заявка.
2) Онбординг заказчика и доступ в личный кабинет.
3) Дизайн‑проект: тендер на дизайнера -> договор -> старт.
4) Дизайн‑проект: этапы -> согласование -> акты.
5) Ремонт: тендер на управляющего -> договор -> базовый бюджет.
6) Ремонт: этап -> акт -> приемка/замечания.
7) Оплата по этапам -> синхронизация с 1С.

**Результат:** матрица приоритетов сценариев и границы МВП.

**Вопросы:**
1) Подтверждаем полный дизайн‑проект в МВП или только тендер+договор?
2) Нужны ли в МВП закупки/логистика, или оставить на следующий этап?

**Решения:**
- МВП включает полный дизайн‑проект: тендер -> договор -> этапы -> акты.
- Закупки и логистика вынесены на следующий этап (не входят в МВП).

## 3. Доменная модель и словарь терминов
**Что делаем:**
- описываем сущности, связи, статусы и жизненные циклы;
- фиксируем единые идентификаторы и владельцев данных (источник правды).

**Результат:** доменная модель, словарь терминов, владельцы данных.

**Вопросы:**
1) Какие сущности считаем обязательными: проект, этап, акт, платеж, договор?
2) Где «источник правды» по проекту и этапам: Битрикс или веб‑контур?

## 4. Контекстная архитектура (диаграмма С4, уровень 1)
**Что делаем:**
- обозначаем границы системы и внешних участников;
- фиксируем внешние системы и каналы.

**Результат:** контекстная диаграмма С4.

**Вопросы:**
1) Есть ли внешние системы кроме Битрикс и 1С (телефония, банки, СДЭК)?

## 5. Контейнерная архитектура (диаграмма С4, уровень 2)
**Что делаем:**
- описываем контейнеры: веб, БФФ, Битрикс24, 1С, интеграционный слой, ИИ;
- фиксируем ответственность и интерфейсы между контейнерами.

**Результат:** контейнерная диаграмма С4 и список интерфейсов.

**Вопросы:**
1) Будет ли отдельный сервис очередей/интеграций или все в БФФ?

## 6. Оркестрация процессов (BPMN / статусные машины)
**Что делаем:**
- описываем маршруты и переходы для ключевых процессов;
- фиксируем правила откатов, блокировок и эскалаций.

**Результат:** BPMN или статусные схемы по 5–7 процессам.

**Вопросы:**
1) Кто окончательно подтверждает этапы: заказчик или ПМ?
2) Как фиксируются «замечания» — как отдельный процесс или статус?

## 7. Интеграционная архитектура (АПИ/вебхуки, синхронизация)
**Что делаем:**
- описываем контракты АПИ, события и вебхуки;
- задаем правила синхронизации, повторов и обработки ошибок;
- фиксируем маппинг данных между веб, Битрикс и 1С.

**Результат:** спецификация интеграций (АПИ, события, маппинг).

**Вопросы:**
1) Какие операции должны быть строго синхронными (например, оплата)?
2) Сколько допустимо задержки между системами?

## 8. Архитектура данных
**Что делаем:**
- описываем схемы данных по контурам;
- определяем хранение файлов и историю изменений;
- задаем политику бэкапов.

**Результат:** ER‑модель, словарь данных, политика хранения.

**Вопросы:**
1) Где будем хранить файлы (локально, S3‑совместимое, другое)?
2) Нужен ли отдельный архив для закрытых проектов?

## 9. Безопасность и РБАК (ролевая модель)
**Что делаем:**
- описываем роли и права доступа;
- фиксируем аудит критичных действий;
- задаем методы аутентификации.

**Результат:** модель доступа и список контролей.

**Вопросы:**
1) Какой способ входа: телефон+СМС, почта, комбинированный?
2) Требуется ли КЭП/УЭП для актов в МВП?

## 10. Нефункциональные требования и наблюдаемость
**Что делаем:**
- фиксируем требования по скорости и нагрузке;
- описываем мониторинг, метрики, алерты.

**Результат:** матрица НФТ и план наблюдаемости.

**Вопросы:**
1) Какой целевой SLA на МВП?
2) Какая пиковая нагрузка по заявкам в день?

## 11. Развертывание и ДевОпс
**Что делаем:**
- описываем окружения (dev/stage/prod);
- фиксируем процесс релизов и откатов;
- задаем правила хранения секретов и бэкапов.

**Результат:** схема развертывания и процесс релизов.

**Вопросы:**
1) Где будем размещать (облако/он‑прем)?
2) Какой цикл релизов допустим (раз в 2 недели, раз в месяц)?

## 12. Дорожная карта и риски
**Что делаем:**
- описываем этапы (МВП, расширение, масштабирование);
- фиксируем зависимости и риски;
- планируем меры снижения рисков.

**Результат:** дорожная карта и реестр рисков.

**Вопросы:**
1) Какие крайние сроки по запуску МВП?
2) Какие риски считаются критичными (интеграции, юрчасть, кадры)?

## 13. Ревью и валидация
**Что делаем:**
- проводим архитектурное ревью с бизнесом и техкомандой;
- делаем мини‑PoC для критичных интеграций.

**Результат:** согласованная архитектура и план валидации.

**Вопросы:**
1) Кто финально утверждает архитектуру (роль/имя)?
2) Какие интеграции нужно проверить в первую очередь?

---

## Минимальный набор артефактов
- HLA (актуализированная версия)
- диаграммы С4: контекст, контейнеры, компоненты
- BPMN/статусные диаграммы по ключевым сценариям
- словарь данных и ER‑модель
- спецификация АПИ и интеграций
- модель безопасности и РБАК
- матрица НФТ и план наблюдаемости
- дорожная карта с этапами и зависимостями

## Ближайшие следующие шаги
1) Утвердить список сценариев МВП (включая оба тендера).
2) Сделать доменную модель и словарь терминов.
3) Подготовить контекстную и контейнерную диаграммы.
